{% extends "admin/base_site.html" %}

{% block content %}
<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;">
  <h1 style="margin:0;">Графики работы: неделя {{ week_start }}</h1>
  <div style="display:flex;gap:8px;">
    <a href="{{ prev_week_url }}" style="padding:6px 10px;border:1px solid #d1d5db;border-radius:8px;text-decoration:none;color:#0f172a;background:#fff;">
      ← Предыдущая неделя
    </a>
    <a href="{{ next_week_url }}" style="padding:6px 10px;border:1px solid #d1d5db;border-radius:8px;text-decoration:none;color:#0f172a;background:#fff;">
      Следующая неделя →
    </a>
  </div>
</div>

<div style="overflow:auto;">
  <table style="width:100%;border-collapse:separate;border-spacing:0;min-width:1200px;">
    <thead>
      <tr>
        {% for day_name, day_date in day_headers %}
        <th style="position:sticky;top:0;background:#0f172a;color:#fff;padding:12px;border:1px solid #1f2937;min-width:170px;">
          <div>{{ day_name }}</div>
          <div style="opacity:.8;font-size:12px;">{{ day_date }}</div>
        </th>
        {% endfor %}
      </tr>
    </thead>
    <tbody>
      <tr>
        {% for bucket in day_buckets %}
        <td style="vertical-align:top;border:1px solid #e5e7eb;padding:10px;background:#fff;">
          {% if bucket %}
            {% for item in bucket %}
              <details style="margin-bottom:8px;border:1px solid {% if item.mode == 'online' %}#60a5fa{% else %}#86efac{% endif %};border-radius:8px;padding:6px 8px;background:{% if item.mode == 'online' %}#eff6ff{% else %}#f0fdf4{% endif %};">
                <summary style="cursor:pointer;font-weight:600;color:{% if item.mode == 'online' %}#1d4ed8{% else %}#166534{% endif %};">{{ item.user_display }}</summary>
                <div style="margin-top:8px;font-size:13px;line-height:1.5;">
                  <div>Время: {{ item.time_range }}</div>
                  <div>Формат: {% if item.mode == 'online' %}online{% else %}offline{% endif %}</div>
                  <a href="{{ item.details_url }}" style="display:inline-block;margin-top:6px;padding:4px 10px;border:1px solid #d1d5db;border-radius:8px;text-decoration:none;">Подробности</a>
                </div>
              </details>
            {% endfor %}
          {% else %}
            <div style="color:#9ca3af;">—</div>
          {% endif %}
        </td>
        {% endfor %}
      </tr>
    </tbody>
  </table>
</div>
{% endblock %}
