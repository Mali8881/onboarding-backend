{% extends "admin/base_site.html" %}

{% block content %}
<div style="max-width: 1100px; margin: 0 auto; padding: 20px;">
  <h1 style="margin-bottom: 16px;">Офисные сети (Whitelist)</h1>
  <p style="color: #4b5563; margin-bottom: 20px;">
    Только пользователи из активных офисных сетей смогут выполнить check-in в режиме "office".
  </p>

  <div style="background: #fff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 16px; margin-bottom: 20px;">
    <h2 style="margin-top: 0;">Добавить сеть</h2>
    <form method="post">
      {% csrf_token %}
      <input type="hidden" name="action" value="create">
      <div style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 12px; align-items: end;">
        <div>
          <label style="display:block; font-weight:600; margin-bottom: 6px;">Название</label>
          <input name="name" type="text" placeholder="Главный офис" style="width:100%; border:1px solid #d1d5db; border-radius:8px; padding:10px;">
        </div>
        <div>
          <label style="display:block; font-weight:600; margin-bottom: 6px;">CIDR</label>
          <input name="cidr" type="text" placeholder="203.0.113.0/24" style="width:100%; border:1px solid #d1d5db; border-radius:8px; padding:10px;">
        </div>
        <div style="display:flex; gap:10px; align-items:center;">
          <label style="display:flex; gap:6px; align-items:center; margin:0;">
            <input name="is_active" type="checkbox" checked> Активна
          </label>
          <button type="submit" class="button default">Добавить</button>
        </div>
      </div>
    </form>
  </div>

  <div style="background: #fff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 16px;">
    <h2 style="margin-top: 0;">Список сетей</h2>
    {% if networks %}
      <table style="width: 100%; border-collapse: collapse;">
        <thead>
          <tr>
            <th style="text-align:left; border-bottom:1px solid #e5e7eb; padding:10px;">Название</th>
            <th style="text-align:left; border-bottom:1px solid #e5e7eb; padding:10px;">CIDR</th>
            <th style="text-align:left; border-bottom:1px solid #e5e7eb; padding:10px;">Статус</th>
            <th style="text-align:left; border-bottom:1px solid #e5e7eb; padding:10px;">Действия</th>
          </tr>
        </thead>
        <tbody>
          {% for n in networks %}
            <tr>
              <td style="border-bottom:1px solid #f3f4f6; padding:10px;">{{ n.name }}</td>
              <td style="border-bottom:1px solid #f3f4f6; padding:10px;"><code>{{ n.cidr }}</code></td>
              <td style="border-bottom:1px solid #f3f4f6; padding:10px;">
                {% if n.is_active %}Активна{% else %}Отключена{% endif %}
              </td>
              <td style="border-bottom:1px solid #f3f4f6; padding:10px;">
                <div style="display:flex; gap:8px;">
                  <form method="post" style="margin:0;">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="toggle">
                    <input type="hidden" name="network_id" value="{{ n.id }}">
                    <button type="submit" class="button">
                      {% if n.is_active %}Выключить{% else %}Включить{% endif %}
                    </button>
                  </form>
                  <form method="post" style="margin:0;" onsubmit="return confirm('Удалить сеть {{ n.name }}?')">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="delete">
                    <input type="hidden" name="network_id" value="{{ n.id }}">
                    <button type="submit" class="button" style="color:#b91c1c;">Удалить</button>
                  </form>
                </div>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p style="color:#6b7280;">Сети пока не добавлены.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
